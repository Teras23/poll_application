CREATE OR REPLACE VIEW v_only_main_requests AS SELECT * FROM requests WHERE request_url NOT LIKE '%.%' AND request_url NOT LIKE '/api/%';
CREATE OR REPLACE VIEW v_only_main_requests_count AS SELECT COUNT(*) FROM requests WHERE request_url NOT LIKE '%.%' AND request_url NOT LIKE '/api/%';
CREATE OR REPLACE VIEW v_date_history AS SELECT FROM_UNIXTIME(FLOOR(UNIX_TIMESTAMP(date_time)/(60*60))*(60*60)) AS datetime, COUNT(id) AS count FROM only_main_requests GROUP BY FROM_UNIXTIME(FLOOR(UNIX_TIMESTAMP(date_time)/(60*60))*(60*60));
CREATE OR REPLACE VIEW v_os_request_count AS SELECT os_group, COUNT(os_group) FROM only_main_requests JOIN request_oss WHERE request_oss.id = only_main_requests.os_id GROUP BY os_group ORDER BY COUNT(os_group) DESC;
CREATE oR REPLACE VIEW v_browser_request_count AS SELECT name, COUNT(name) FROM only_main_requests JOIN request_browsers WHERE request_browsers.id = only_main_requests.browser_id GROUP BY name;